' Gambas module file

Public Sub Main()

  Dim sBuffer As String
  While Not Eof()
    sBuffer &= Read -4096
  Wend
  Run(sBuffer)

End

Private Sub Run(Script As String) As String
  
  Dim sTempPath As String = Temp()
  Dim sScriptPath As String = sTempPath &/ "script.gbs"
  
  Mkdir sTempPath
  File.Save(sScriptPath, Script)
  
  Exec ["gbs3", sScriptPath] Wait
  
End
