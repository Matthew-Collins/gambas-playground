' Gambas class file

Public ContentType As String
Public Content As String
Public Status As Integer

Public Sub New(Optional sContentType As String = "text/plain", Optional iStatus As Integer = 0)

  Me.ContentType = sContentType
  Me.Status = iStatus

End

Public Sub Write(Value As String)

  Content &= Value

End

Public Sub WriteLine(Value As String)

  Content &= Value & gb.NewLine

End

Public Sub LoadFile(FileName As String)

  Me.ContentType = Response.GetContentTypeFrom(FileName)
  Me.Content &= File.Load(FileName)

End

Public Sub SendFile(FileName)
  Response.Begin
  Response.Status = Me.Status
  Response.AddHeader("Access-Control-Allow-Origin", "*")
  Response.SendFile(FileName)
End

Public Sub Respond(Optional ClearAfterSend As Boolean = False)

  Response.Begin
  Response.Status = Me.Status
  Response.AddHeader("Access-Control-Allow-Origin", "*")
  Response.ContentType = Me.ContentType
  Print Content
  Response.End
  If ClearAfterSend Then
    Me.Clear
  Endif
End

Public Sub Clear()

  Me.Content = ""

End
